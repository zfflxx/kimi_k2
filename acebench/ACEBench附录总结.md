# ACEBench附录总结

## 数据类型详细描述

### Normal数据类型

**Single-Turn（单轮）**
- 用户与助手仅有一轮交互
- 分为单轮单函数调用和单轮并行函数调用

**Multi-Turn（多轮）**
- 用户与助手有多次交互
- 两种类型：
  - **Switch（切换）**：通过改变话题推进对话
  - **Adjust（调整）**：通过细化或修改原问题推进对话

**Similar APIs（相似API）**
- 候选API表现出显著相似性，特别是关注同一主题
- 测试助手区分相似API并准确选择最合适API的能力

**Preference（偏好）**
- 除候选API外，还提供补充用户配置文件数据
- 要求助手挖掘用户特定因素（过往交互、兴趣、个性化属性）来生成参数值

**Atom（原子）**
- 包含特定参数类型的API集合
- 分为五种类型：number（数字）、enum（枚举）、list（列表）、bool（布尔）、object（对象）
- 旨在探索函数参数类型是否影响模型的数据填充能力

### Special数据类型

指模型无法使用候选函数解决指令中问题的情况：

**Incomplete（不完整）**
- 查询中缺少函数调用所需的关键信息
- 如缺少"required"参数

**Error（错误）**
- 指令包含不符合要求格式或约束的参数或名称
- 如不匹配特定模式或从预定义列表中选择

**Irrelevant（无关）**
- 指令超出函数能力
- 没有候选函数能解决问题

### Agent数据类型

基于真实世界场景构建的环境中完成任务，通常需要多个步骤：

**Multi-Step（多步）**：用户在整个对话中只出现一次
**Multi-Turn（多轮）**：用户在对话过程中多次出现

## 数据构建方法

### Agent数据构建流程

1. **场景分析**：深入分析真实世界场景，提取关键任务需求并模块化为不同领域的子场景
2. **代码实现**：为每个功能实现逻辑抽象，设计用户认证、成本计算、支付处理等核心流程
3. **交互规则设计**：基于特定场景需求设计交互规则，标准化用户与Agent的交互过程
4. **问题格式设计**：结合真实世界需求设计问题格式和解决方案

### Special数据构建示例

**Incomplete数据构建**：
- 使用模板提示生成对话，提取缺失参数信息
- 示例：航班预订缺少出发城市参数

**Error数据构建**：
- 生成包含格式错误参数的对话
- 示例：团队名称包含不符合正则表达式的特殊字符

## 评估推理提示

### Normal数据提示
- 基于API规范和对话历史生成API请求
- 输出格式：`[ApiName(key1='value1', key2='value2', ...)]`
- 对于Preference数据，额外包含用户配置文件信息

### Special数据提示
- 两种场景处理：
  1. 信息清晰时正常调用API
  2. 信息不明确时指出问题：
     - 错误值：`["There is incorrect value (value) for the parameters (key)"]`
     - 缺失参数：`["Missing necessary parameters (key1, key2, ...) for the api (ApiName)"]`
     - 超出能力：`["Due to the limitations of the function, I cannot solve this problem."]`

### Agent数据提示
- 针对特定场景的详细规则说明
- 示例：移动助手场景包含短信发送、提醒添加、外卖订购等功能的具体操作规则

## 总体准确率计算公式

$$\text{All Acc} = A \cdot \text{Acc}_{\text{Normal}} + B \cdot \text{Acc}_{\text{Special}} + C \cdot \text{Acc}_{\text{Agent}}$$

其中权重系数为：

$$A = \frac{\sqrt{n_{\text{Normal}}}}{\sqrt{n_{\text{Normal}}} + \sqrt{n_{\text{Special}}} + \sqrt{n_{\text{Agent}}}}$$

$$B = \frac{\sqrt{n_{\text{Special}}}}{\sqrt{n_{\text{Normal}}} + \sqrt{n_{\text{Special}}} + \sqrt{n_{\text{Agent}}}}$$

$$C = \frac{\sqrt{n_{\text{Agent}}}}{\sqrt{n_{\text{Normal}}} + \sqrt{n_{\text{Special}}} + \sqrt{n_{\text{Agent}}}}$$

## 详细实验结果

### 英文数据集结果亮点
- **最佳表现**：GPT-4o (81.1%)、GPT-4-Turbo (80.3%)
- **开源模型领先**：Qwen2.5-Coder-32B-Instruct (73.9%)、DeepSeek-V3 (71.1%)
- **微调模型问题**：Watt-Tool-8B在Special数据上仅2.0%，显示泛化能力丧失

### 中文数据集结果亮点
- **整体表现更好**：GPT-4o达到89.6%
- **开源模型突出**：Qwen2.5-Coder-32B-Instruct (85.3%)在开源模型中表现最佳
- **语言差异**：中文数据集上模型普遍表现优于英文数据集

## 错误类型分析

### Normal数据错误类型
1. **参数值错误**：最常见，模型难以生成特定值
2. **输出格式错误**：第二常见，格式规范遵循问题
3. **函数名错误**：较少见
4. **参数类型错误**：较少见

### Special数据错误类型
1. **错误检测**：完全未能检测到指令问题（主要错误类型）
2. **错误纠正**：检测到问题但反馈不清晰

### Agent数据错误原因
1. **函数调用错误**：选择错误函数或参数不符合规范
2. **规则违反**：忽视预定义场景规则
3. **信息管理不当**：多轮交互中无法正确处理上下文信息

## 关键洞察

1. **复杂任务挑战**：大多数模型在Agent数据上端到端准确率低于50%
2. **微调副作用**：专门微调的模型在Special数据上表现显著下降
3. **参数值生成困难**：跨所有模型的最大挑战
4. **代码训练效果**：对较大模型（14B+）更有效，对小模型效果有限
5. **扩展规律**：模型性能随规模增长，但边际收益递减